
{% extends "home.html" %}

{%block main %}

 <div class="row">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th></th>
                    <th>Name</th>
                    <th>Next due</th>
		    <th>Next reminder</th>
                    <th>Repeats</th>
		    <th>Shared task</th>
		    <th>Reminders</th>
            <th></th>
            <th></th>
            </tr>
            </thead>
            <tbody>
                
        {% for t in tasks %}
            <tr>
                <td>{{points_helper.points(t.points)}}</td>
                <td><span class="tt-below" title="{{t.desc|truncate(length=64, killwords=False, end='...')}}">
        			{{t.name|truncate(length=32,killwords=False,end='...')}}</span>
                </td>
                <td>{% set ne = t.next_due_utc() %}<span class="tt-right" title="{{t.localize(ne)}}">
                          {{t.pretty(ne)}}</span>
                </td>
		        <td>
                    {% set ne = t.next_reminder_utc() %}<span class="tt-right" title="{{t.localize(ne)}}">
                          {{t.pretty(ne)}}</span>
                </td>
                <td>{{t.describe_repeat()|safe}}</td>
		        <td>{% if t.shared_task %}
                        <i class="icon-ok tt-right" title="{{t.shared_desc}} housemates must complete the task before it is marked as 'done'"></i>
                        {%else%}
                            -
                        {%endif%}
                </td>
        		<td>{% if t.no_reminder %}-{%else%}<i class="tt-right icon-ok" title="{{ t.reminders|join(', ') }}"></i>{%endif%}</td>
                <td value="{{t.key.id()}}" class="tt-below edit-task" title="Edit task"><i class="icon-edit"></i></td>
                <td value="{{t.key.id()}}" class="tt-below delete-task" title="Delete task"><i class="icon-trash"></i></td>
            </tr>
        {%endfor%}
        
        <tr>
            <td id="add-repeated-task" colspan="100" align="center"> <i class="icon-plus"></i> Add a task</td></a>
        </tr>
        

	
            </tbody>
        </table>        
    </div>

{%endblock%}

{%block javascript %}
<script>
$('.tt-right').tooltip( {
	    placement: 'right'
	});
$('.tt-below').tooltip( {
	    placement: 'bottom'
	});
        
$('#add-repeated-task').click(function() {
    window.location = '/task/create';
});

$('.edit-task').bind('click',function() {
    window.location = '/task/edit?id=' + $(this).attr('value');
});

$('.delete-task').bind('click',function() {
   window.location = '/task/delete?id=' + $(this).attr('value');
});

</script>
{%endblock%}